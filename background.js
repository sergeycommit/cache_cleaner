function getDomainAndTLD(e){let t=new URL(e),a=t.hostname.split(".");return a.length>2?a.slice(-2).join("."):t.hostname}function clearHistoryLastHour(e){let t=Date.now()-36e5;chrome.browsingData.removeHistory({since:t},function(){console.log("Browser history cleared for the last hour"),e&&e()})}function legacyCleanup(e){let t=getDomainAndTLD(e.url);chrome.cookies.getAll    ({domain:t},e=>{for(let t of e){let a=`http${t.secure?"s":""}://${t.domain}${t.path}`;chrome.cookies.remove({url:a,name:t.name})}}),chrome.scripting.executeScript({target:{tabId:e.id},function(){localStorage.clear(),sessionStorage.clear(),window.indexedDB&&window.indexedDB.databases&&window.indexedDB.databases().then(e=>{e.forEach(e=>{window.indexedDB.deleteDatabase(e.name)})}),location.reload()}},()=>{chrome.action.setBadgeText({text:"Done",tabId:e.id}),setTimeout(()=>{chrome.action.setBadgeText({text:"",tabId:e.id})},2e3)})}chrome.runtime.onMessage.addListener((e,t,a)=>"getTabInfo"===e.action?(chrome.tabs.query({active:!0,currentWindow:!0},e=>{e.length>0?a({url:e[0].url,tabId:e[0].id}):a({error:"No active tab found"})}),!0):"clearHistory"===e.action?(clearHistoryLastHour(()=>{a({status:"History cleared"})}),!0):void 0),chrome.runtime.onInstalled.addListener(()=>{chrome.action.setBadgeBackgroundColor({color:"#4a90e2"})}),chrome.action.onClicked.addListener(e=>{chrome.action.getPopup||legacyCleanup(e)});